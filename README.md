# Vegas2Resolve preset convertor
_It was easier to make this, than learn Vegas because of some presets_

This set of tools was made to convert Vegas Pro presets to Resolve Fusion. Unfortunately, it only works for OFX plugins, that are available in both programs - it can export native Vegas effects, but they will not work in Fusion.

Tested on Vegas Pro 18 build 334 and Resolve 19.


- [Vegas2Resolve preset convertor](#vegas2resolve-preset-convertor)
  - [Vegas Exporter](#vegas-exporter)
    - [Instalaion](#instalaion)
    - [Usage](#usage)
    - [Supported plugins](#supported-plugins)
  - [Resolve Importer](#resolve-importer)
    - [Instalaion](#instalaion-1)
  - [Usage](#usage-1)
    - [Supported plugins](#supported-plugins-1)
    - [Known issues](#known-issues)
  - [JSON structures](#json-structures)
    - [Preset structure](#preset-structure)
    - [OFX IDs list](#ofx-ids-list)
      - [GetOFXIDs.py](#getofxidspy)

<a id="Vegas-Exporter"></a>
## Vegas Exporter

<a id="Vinstalation"></a>
### Instalaion

1. Download the latest release from the [releases page](https://github.com/martasskv5/Vegas2Resolve/releases/)
2. Unpack the archive
3. Copy `[Martas] Exporter.dll` and `Newtonsoft.Json.dll` to the Vegas scripts folder (usually `C:\Program Files\VEGAS\VEGAS Pro XX.X\Script Menu`)

Optional: you dont have to copy the files, just remeber the path to the folder

<a id="Vusage"></a>
### Usage

1. Open Vegas Pro
2. Select clips with preset you want to export
3. Go to `Tools` -> `Scripting` -> `[Martas] Exporter` or `Tools` -> `Scripting` -> `Run script...` and select the _dll_ file
4. Select the folder where you want to save the preset

<a id="Vsupp"></a>
### Supported plugins

- Any OFX plugin

<a id="Resolve-Importer"></a>
## Resolve Importer

<a id="Rinstalation"></a>
### Instalaion

1. Download the latest release from the [releases page](https://github.com/martasskv5/Vegas2Resolve/releases/)
2. Unpack the archive
3. Copy `Martas` folder to the Resolve scripts folder (usually `%APPDATA%\Blackmagic Design\DaVinci Resolve\Support\Fusion\Scripts\Utility`)

<a id="Rusage"></a>
## Usage

1. Open Resolve
2. Create new Fusion composition
3. Go to `Fusion` page
4. Go to `Workspace` -> `Scripts` -> `Martas` -> `FX Importer`
![image](other/1.png)
5. Select the json file you want to import
6. Select [OFX IDs list](#ofx-ids-list)
7. Optionally, uncheck `Exit on completion` to import multiple presets
8. Click `Import`
9. Wait for the script to finish and then save your nodes as _setting_ file

<a id="Rsupp"></a>
### Supported plugins

I have tested the script with the following plugins:

- Sapphire 2024
- BCC 2024
- Red Giant Universe 2024
- Red Giant Magic Bullet Suite 2024
- Twixtor 7
- Ignite Pro `coming soon`

<a id="Rissues"></a>
### Known issues

- Universe plugin takes longer time to import, because its parameters are represented as a numbers. Easiest way to solve this, that I found was to brute force these values. If you have a better idea, please let me know.

<a id="json"></a>
## JSON structures

<a id="preset-structure"></a>
### Preset structure

```json
[
    {
        "Description": "Plugin name",
        "Parameters": [
            "Label": "Parameter name",
            "Value": "Value",
            "Keyframes": [
                {
                    "Time": {
                        "Nanos": 0,
                        "FrameCount": 0,
                        "FrameRate": 29.970029970029969
                    },
                    "Value": "Value"
                }
            ]
        ]
    }
]
```

- `Description` - name of the plugin, used to match with [plugin ID](#ofx-ids-list)
- `Parameters` - list of parameters
- `Label` - name of the parameter
- `Value` - value of the parameter, normally float. Other types:
  - `Color` - RGB color, values are from 0 to 255
    ```json
    {
        "R": 240.0,
        "G": 30.0,
        "B": 125.0
    }
    ```
  - `Point` - X and Y coordinates, values are from 0 to 1
    ```json
    {
        "X": 0.0,
        "Y": 0.0
    }
    ```
  - `Combobox` - the dropdown menu, name is only for reference
    ```json
    {
        "Name": "Value",
        "Index": 0
    }
    ```
  - `Checkbox` - value is `1` or `0` -> `true` or `false`
      ```json
      {
          "Value": 1
      }
      ```
- `Keyframes` - list of keyframes, optional
  - `Nanos` - value generated by Vegas, not used in Resolve
  - `FrameRate` - value generated by Vegas, not used in Resolve
  - `FrameCount` - frame number
  - `Value` - value at the keyframe

<a id="ofx-ids-list"></a>
### OFX IDs list

I cant use the FX name, eg. `S_Shake`, to add it into Fusion, instead I have to use the OFX ID, eg. `ofx.com.genarts.sapphire.Distort.S_Shake`. The provided `OFXIDs.json` list does not conatian all the FX, but you can easily extend it for supported plugins by using `GetOFXIDs.py` script.

<a id="GetOFXIDs.py"></a>
#### GetOFXIDs.py

_Note: this script only works with presets exported form Vegas_

1. Open the script in any text editor
2. Replace the `folder` variable with the path to the folder with exported presets and `dictionary_path` with the path to the `OFXIDs.json` file
3. Run the script